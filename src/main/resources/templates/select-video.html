<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- 1. Include Shared Head (Imports Bootstrap, Fonts, and style.css) -->
<head th:replace="~{fragments/head :: common-head('Select Video', '/css/pages/video.css')}"></head>

<body>

<!-- Wrapper for scrolling -->
<div class="page-scrollable">
    <div class="container py-5">

        <!-- Page Header -->
        <div class="page-header">
            <div class="row align-items-end">
                <div class="col-md-8">
                    <a th:href="@{/watch/manage}" class="back-link">
                        <i class="bi bi-chevron-left"></i> Back to My Rooms
                    </a>
                    <h1 class="display-5 fw-bold mb-0 text-white">Select Video</h1>
                    <p class="text-secondary mt-2 mb-0">Choose a file from your Google Drive to start a new watch party.</p>
                </div>
                <div class="col-md-4 text-md-end d-none d-md-block">
                    <span class="badge rounded-pill px-3 py-2" style="background: rgba(56, 189, 248, 0.1); color: var(--accent); border: 1px solid var(--accent);">
                        <i class="bi bi-google me-2"></i> Drive Sync Active
                    </span>
                </div>
            </div>
        </div>

        <!-- Video Selection Grid -->
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">

            <!-- Loop: Active Files -->
            <div class="col" th:each="file : ${files}">
                <div class="glass-card video-card h-100 p-4">

                    <!-- Center Icon -->
                    <div class="icon-container">
                        <i class="bi bi-file-earmark-play-fill video-icon"></i>
                    </div>

                    <div class="text-center mb-4">
                        <h5 class="fw-bold text-white text-truncate" th:text="${file.name}" th:title="${file.name}">Video Name</h5>
                        <p class="small text-muted mb-0">Ready to stream</p>
                    </div>

                    <form th:action="@{/watch/create}" method="post">
                        <input type="hidden" name="fileId" th:value="${file.id}">
                        <input type="hidden" name="fileName" th:value="${file.name}">

                        <div class="mb-3">
                            <label class="form-label small fw-bold text-uppercase text-muted opacity-75" style="letter-spacing: 1px;">Room Name</label>
                            <input type="text" name="roomName" class="form-control form-control-dark"
                                   placeholder="e.g. Movie Night" required>
                        </div>

                        <button type="submit" class="btn btn-accent w-100 py-3 mt-2">
                            Create Party <i class="bi bi-plus-lg ms-2"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- EMPTY STATE -->
        <div th:if="${#lists.isEmpty(files)}" class="row justify-content-center mt-5">
            <div class="col-md-6 text-center">
                <div class="glass-card p-5">
                    <i class="bi bi-cloud-slash display-1 text-muted mb-4 d-block opacity-25"></i>
                    <h3 class="fw-bold text-white">No Videos Found</h3>
                    <p class="text-secondary">We couldn't find any supported video files in your Google Drive.<br>
                        Try uploading an MP4 file and refreshing this page.</p>
                    <a href="https://drive.google.com" target="_blank" class="btn btn-outline-info rounded-pill px-4 mt-3">
                        Open Google Drive <i class="bi bi-box-arrow-up-right ms-2"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- 3. Global Notifications -->
<div th:replace="~{fragments/notifications :: global-notifications}"></div>

</body>
</html>